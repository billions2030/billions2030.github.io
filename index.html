<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>나의 공모주 관리</title>
    <style>
        body {
            font-family: 'Malgun Gothic', '맑은 고딕', Arial, sans-serif; /* 글꼴 지정 */
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5; /* 배경색 */
            display: flex; /* 내용을 가운데 정렬하기 위함 */
            justify-content: center;
            align-items: flex-start; /* 상단에 붙도록 정렬 */
            min-height: 100vh; /* 화면 전체 높이 */
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); /* 그림자 효과 */
            width: 100%;
            max-width: 600px; /* 최대 너비 설정 */
            box-sizing: border-box; /* 패딩, 보더 포함 너비 계산 */
        }
        h1 {
            color: #2c3e50; /* 제목 색상 */
            text-align: center;
            margin-bottom: 25px;
        }
        label {
            display: block; /* 한 줄 전체 사용 */
            margin-bottom: 8px; /* 아래 여백 */
            font-weight: bold; /* 글자 두껍게 */
            color: #34495e; /* 글자색 */
        }
        input[type="text"],
        input[type="number"],
        input[type="date"],
        textarea {
            width: calc(100% - 24px); /* 좌우 패딩 고려 너비 */
            padding: 12px;
            margin-bottom: 15px; /* 아래 여백 */
            border: 1px solid #ced4da; /* 테두리 색상 */
            border-radius: 6px; /* 테두리 둥글게 */
            box-sizing: border-box; /* 패딩, 보더 포함 너비 계산 */
            font-size: 16px;
        }
        textarea {
            resize: vertical; /* 세로 크기 조절 가능 */
        }
        button {
            background-color: #28a745; /* 버튼 배경색 (초록색 계열) */
            color: white; /* 버튼 글자색 */
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            cursor: pointer; /* 마우스 커서 변경 */
            font-size: 18px;
            font-weight: bold;
            display: block; /* 블록 요소로 만들어 너비 100% 사용 */
            width: 100%;
            transition: background-color 0.3s ease; /* 부드러운 색상 변화 */
        }
        button:hover {
            background-color: #218838; /* 마우스 올렸을 때 색상 */
        }
        #output {
            margin-top: 30px;
            padding: 20px;
            background-color: #e9ecef;
            border-radius: 8px;
            white-space: pre-wrap; /* 줄 바꿈이 잘 보이게 해줍니다 */
            border: 1px solid #dee2e6;
            color: #495057;
            font-size: 15px;
            line-height: 1.6; /* 줄 간격 */
            word-break: break-all; /* 긴 단어 강제 줄바꿈 */
        }
        /* 반응형 디자인을 위한 미디어 쿼리 */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                border-radius: 8px;
            }
            h1 {
                font-size: 24px;
            }
            input[type="text"], input[type="number"], input[type="date"], textarea, button {
                font-size: 15px;
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>나의 공모주 관리표</h1>

        <label for="stockName">종목 이름:</label>
        <input type="text" id="stockName" placeholder="예: 삼성전자">

        <label for="applyDate">청약일:</label>
        <input type="date" id="applyDate">

        <label for="listingDate">상장일:</label>
        <input type="date" id="listingDate">

        <label for="refundDate">환불일:</label>
        <input type="date" id="refundDate">

        <label for="applyQuantity">청약 수량:</label>
        <input type="number" id="applyQuantity" placeholder="예: 100">

        <label for="applyAmount">청약 금액 (원):</label>
        <input type="number" id="applyAmount" placeholder="예: 1000000">

        <label for="allocatedQuantity">배정 수량:</label>
        <input type="number" id="allocatedQuantity" placeholder="예: 50">

        <label for="profitAmount">수익금 (원):</label>
        <input type="number" id="profitAmount" placeholder="예: 50000">

        <label for="lockupPeriod">의무보유확약 기간:</label>
        <input type="text" id="lockupPeriod" placeholder="예: 1개월, 3개월, 해당없음">

        <label for="lockupReleaseDate">의무보유확약 해제일:</label>
        <input type="date" id="lockupReleaseDate">

        <label for="memo">메모:</label>
        <textarea id="memo" rows="4" placeholder="특별히 기억하고 싶은 내용을 적어주세요."></textarea>

        <button onclick="saveData()">정보 저장</button>

        <div id="output">
            정보가 저장되면 구글 스프레드시트에서 확인해주세요.
        </div>
    </div>

    <script>
        function saveData() {
            // 각 입력 칸에서 사용자가 입력한 내용을 가져옵니다.
            const stockName = document.getElementById('stockName').value;
            const applyDate = document.getElementById('applyDate').value;
            const listingDate = document.getElementById('listingDate').value;
            const refundDate = document.getElementById('refundDate').value;
            const applyQuantity = document.getElementById('applyQuantity').value;
            const applyAmount = document.getElementById('applyAmount').value;
            const allocatedQuantity = document.getElementById('allocatedQuantity').value;
            const profitAmount = document.getElementById('profitAmount').value;
            const lockupPeriod = document.getElementById('lockupPeriod').value;
            const lockupReleaseDate = document.getElementById('lockupReleaseDate').value;
            const memo = document.getElementById('memo').value;

            // N8N 웹훅(Webhook) 주소를 여기에 붙여넣으세요!
            const n8nWebhookUrl = 'https://billions2030.app.n8n.cloud/webhook-test/65ebb62a-96f8-42aa-bf87-e9d6b947bcfb'; // 당신의 실제 Webhook URL로 변경되어 있어야 합니다.

            // 입력된 정보들을 하나의 묶음(객체)으로 만듭니다.
            const postData = {
                stockName: stockName,
                applyDate: applyDate,
                listingDate: listingDate,
                refundDate: refundDate,
                applyQuantity: applyQuantity,
                applyAmount: applyAmount,
                allocatedQuantity: allocatedQuantity,
                profitAmount: profitAmount,
                lockupPeriod: lockupPeriod,
                lockupReleaseDate: lockupReleaseDate,
                memo: memo
            };

            // N8N 웹훅으로 정보를 보내는 부분입니다.
            fetch(n8nWebhookUrl, {
                method: 'POST', // 정보를 보낼 때 사용하는 방식
                headers: {
                    'Content-Type': 'application/json' // 보내는 정보의 종류가 JSON이라는 뜻
                },
                body: JSON.stringify(postData) // 우리가 만든 정보를 JSON 형태로 바꿔서 보냅니다.
            })
            .then(response => {
                // 응답이 JSON 형식이 아닐 수도 있으므로 먼저 확인합니다.
                const contentType = response.headers.get("content-type");
                if (contentType && contentType.indexOf("application/json") !== -1) {
                    return response.json();
                } else {
                    return response.text().then(text => { // JSON이 아니면 텍스트로 읽습니다.
                        console.log('N8N Raw Response:', text);
                        return { message: text || 'N8N 응답은 JSON이 아니지만, 전송 시도는 완료되었습니다.' };
                    });
                }
            })
            .then(data => {
                console.log('N8N 응답:', data); // 개발자 도구에 N8N 응답을 보여줍니다.
                alert('정보가 성공적으로 저장되었습니다!'); // 성공 알림

                // 입력창을 비워줘서 다음 정보를 입력하기 쉽게 만듭니다.
                document.getElementById('stockName').value = '';
                document.getElementById('applyDate').value = '';
                document.getElementById('listingDate').value = '';
                document.getElementById('refundDate').value = '';
                document.getElementById('applyQuantity').value = '';
                document.getElementById('applyAmount').value = '';
                document.getElementById('allocatedQuantity').value = '';
                document.getElementById('profitAmount').value = '';
                document.getElementById('lockupPeriod').value = '';
                document.getElementById('lockupReleaseDate').value = '';
                document.getElementById('memo').value = '';
            })
            .catch((error) => {
                console.error('정보 저장 중 오류 발생:', error); // 오류가 나면 개발자 도구에 보여줍니다.
                alert('정보 저장에 실패했습니다. 다시 시도해주세요. (콘솔 로그 확인)'); // 실패 알림
            });
        }
    </script>
</body>
</html>
